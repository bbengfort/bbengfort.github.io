<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Gmail Notifications with Python | Libelli</title>
<meta name=keywords content><meta name=description content="I routinely have long-running scripts (e.g. for a data processing task) that I  want to know when they&rsquo;re complete. It seems like it should be simple for me to add in a little snippet of code that will send an email using Gmail to notify me, right? Unfortunately, it isn&rsquo;t quite that simple for a lot of reasons, including security, attachment handling, configuration, etc. In this snippet, I&rsquo;ve attached my constant copy and paste notify() function, written into a command line script for easy sending on the command line."><meta name=author content="Benjamin Bengfort"><link rel=canonical href=https://bbengfort.github.io/2017/04/gmail-notifications-python/><link crossorigin=anonymous href=/assets/css/stylesheet.fc220c15db4aef0318bbf30adc45d33d4d7c88deff3238b23eb255afdc472ca6.css integrity="sha256-/CIMFdtK7wMYu/MK3EXTPU18iN7/MjiyPrJVr9xHLKY=" rel="preload stylesheet" as=style><link rel=icon href=https://bbengfort.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://bbengfort.github.io/icon.png><link rel=icon type=image/png sizes=32x32 href=https://bbengfort.github.io/icon.png><link rel=apple-touch-icon href=https://bbengfort.github.io/apple-touch-icon-precomposed.png><link rel=mask-icon href=https://bbengfort.github.io/icon.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://bbengfort.github.io/2017/04/gmail-notifications-python/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-D3BE7EHHVP"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-D3BE7EHHVP")}</script><meta property="og:title" content="Gmail Notifications with Python"><meta property="og:description" content="I routinely have long-running scripts (e.g. for a data processing task) that I  want to know when they&rsquo;re complete. It seems like it should be simple for me to add in a little snippet of code that will send an email using Gmail to notify me, right? Unfortunately, it isn&rsquo;t quite that simple for a lot of reasons, including security, attachment handling, configuration, etc. In this snippet, I&rsquo;ve attached my constant copy and paste notify() function, written into a command line script for easy sending on the command line."><meta property="og:type" content="article"><meta property="og:url" content="https://bbengfort.github.io/2017/04/gmail-notifications-python/"><meta property="og:image" content="https://bbengfort.github.io/bear.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2017-04-17T12:26:55+00:00"><meta property="article:modified_time" content="2017-04-17T12:26:55+00:00"><meta property="og:site_name" content="Libelli"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://bbengfort.github.io/bear.png"><meta name=twitter:title content="Gmail Notifications with Python"><meta name=twitter:description content="I routinely have long-running scripts (e.g. for a data processing task) that I  want to know when they&rsquo;re complete. It seems like it should be simple for me to add in a little snippet of code that will send an email using Gmail to notify me, right? Unfortunately, it isn&rsquo;t quite that simple for a lot of reasons, including security, attachment handling, configuration, etc. In this snippet, I&rsquo;ve attached my constant copy and paste notify() function, written into a command line script for easy sending on the command line."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://bbengfort.github.io/posts/"},{"@type":"ListItem","position":2,"name":"Gmail Notifications with Python","item":"https://bbengfort.github.io/2017/04/gmail-notifications-python/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Gmail Notifications with Python","name":"Gmail Notifications with Python","description":"I routinely have long-running scripts (e.g. for a data processing task) that I want to know when they\u0026rsquo;re complete. It seems like it should be simple for me to add in a little snippet of code that will send an email using Gmail to notify me, right? Unfortunately, it isn\u0026rsquo;t quite that simple for a lot of reasons, including security, attachment handling, configuration, etc. In this snippet, I\u0026rsquo;ve attached my constant copy and paste notify() function, written into a command line script for easy sending on the command line.\n","keywords":[],"articleBody":"I routinely have long-running scripts (e.g. for a data processing task) that I want to know when they’re complete. It seems like it should be simple for me to add in a little snippet of code that will send an email using Gmail to notify me, right? Unfortunately, it isn’t quite that simple for a lot of reasons, including security, attachment handling, configuration, etc. In this snippet, I’ve attached my constant copy and paste notify() function, written into a command line script for easy sending on the command line.\nGmail Setup If you’re like me, you have a gmail account with 2-factor authentication (and if you don’t, you should get that set up). In order to use this account to send email from, you’re going to have to configure gmail as follows:\nAllow less secure apps to access your account Create a Sign in using App Passwords Alternatively you could create an account to solely send notifications from and not give it two factor authentication, but you’d still have to do step 1. Even if you do all this stuff, Google Apps can still get in the way, so be sure to inspect any errors you get carefully!\nEnvironment Setup This script and most of my Python scripts contain configuration and security information in the environment. Therefore, open up your .profile or other shell environment and add the following variables.\n## Notify Environment export EMAIL_USERNAME=you@gmail.com export EMAIL_PASSWORD=supersecret export EMAIL_HOST=smtp.gmail.com export EMAIL_PORT=587 export EMAIL_FAIL_SILENT=False I’ve also used YAML configuration, dotenv files, and all sorts of other configuration for this as well. Choose what suits your application\nNotify Script And here is a command line version of the script that wraps the notify() function. Note that it’s basic functionality is to send a simple alert and maybe attach some log or results files to the email, not to routinely send large amounts of HTML formatted messages!\nUsage So now you can send a simple notification as follows:\n$ notify.py -r jdoe@exmaple.com Or you can edit the subject and message with a few attachments:\n$ notify.py -r jdoe@example.com -s \"computation complete\" results.csv Future versions of this script will allow you to pipe the message in via stdin so that you can chain the emailer along the command line. I also plan to do a better configuration, similar to how AWS CLI configures itself in a simple file in the home directory.\n","wordCount":"398","inLanguage":"en","image":"https://bbengfort.github.io/bear.png","datePublished":"2017-04-17T12:26:55Z","dateModified":"2017-04-17T12:26:55Z","author":{"@type":"Person","name":"Benjamin Bengfort"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://bbengfort.github.io/2017/04/gmail-notifications-python/"},"publisher":{"@type":"Organization","name":"Libelli","logo":{"@type":"ImageObject","url":"https://bbengfort.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://bbengfort.github.io/ accesskey=h title="Libelli (Alt + H)"><img src=https://bbengfort.github.io/icon.png alt aria-label=logo height=35>Libelli</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://bbengfort.github.io/archive/ title=archive><span>archive</span></a></li><li><a href=https://bbengfort.github.io/categories/ title=categories><span>categories</span></a></li><li><a href=https://bbengfort.github.io/search/ title="search (Alt + /)" accesskey=/><span>search</span></a></li><li><a href=https://bbengfort.github.io/about/ title=about><span>about</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://bbengfort.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://bbengfort.github.io/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">Gmail Notifications with Python</h1><div class=post-meta><span title='2017-04-17 12:26:55 +0000 UTC'>April 17, 2017</span>&nbsp;·&nbsp;2 min&nbsp;·&nbsp;398 words&nbsp;·&nbsp;Benjamin Bengfort&nbsp;|&nbsp;<a href=https://github.com/bbengfort/bbengfort.github.io/tree/main/content/posts/2017-04-17-gmail-notifications-python.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=post-content><p>I routinely have long-running scripts (e.g. for a data processing task) that I want to know when they&rsquo;re complete. It seems like it should be simple for me to add in a little snippet of code that will send an email using Gmail to notify me, right? Unfortunately, it isn&rsquo;t quite that simple for a lot of reasons, including security, attachment handling, configuration, etc. In this snippet, I&rsquo;ve attached my constant copy and paste <code>notify()</code> function, written into a command line script for easy sending on the command line.</p><h2 id=gmail-setup>Gmail Setup<a hidden class=anchor aria-hidden=true href=#gmail-setup>#</a></h2><p>If you&rsquo;re like me, you have a gmail account with 2-factor authentication (and if you don&rsquo;t, you should get that set up). In order to use this account to send email from, you&rsquo;re going to have to configure gmail as follows:</p><ol><li><a href=https://support.google.com/accounts/answer/6010255>Allow less secure apps to access your account</a></li><li><a href=https://support.google.com/accounts/answer/185833>Create a Sign in using App Passwords</a></li></ol><p>Alternatively you could create an account to solely send notifications from and not give it two factor authentication, but you&rsquo;d still have to do step 1. Even if you do all this stuff, Google Apps can still get in the way, so be sure to inspect any errors you get carefully!</p><h2 id=environment-setup>Environment Setup<a hidden class=anchor aria-hidden=true href=#environment-setup>#</a></h2><p>This script and most of my Python scripts contain configuration and security information in the environment. Therefore, open up your <code>.profile</code> or other shell environment and add the following variables.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1>## Notify Environment</span>
</span></span><span class=line><span class=cl><span class=nb>export</span> <span class=nv>EMAIL_USERNAME</span><span class=o>=</span>you@gmail.com
</span></span><span class=line><span class=cl><span class=nb>export</span> <span class=nv>EMAIL_PASSWORD</span><span class=o>=</span>supersecret
</span></span><span class=line><span class=cl><span class=nb>export</span> <span class=nv>EMAIL_HOST</span><span class=o>=</span>smtp.gmail.com
</span></span><span class=line><span class=cl><span class=nb>export</span> <span class=nv>EMAIL_PORT</span><span class=o>=</span><span class=m>587</span>
</span></span><span class=line><span class=cl><span class=nb>export</span> <span class=nv>EMAIL_FAIL_SILENT</span><span class=o>=</span>False
</span></span></code></pre></div><p>I&rsquo;ve also used YAML configuration, dotenv files, and all sorts of other configuration for this as well. Choose what suits your application</p><h2 id=notify-script>Notify Script<a hidden class=anchor aria-hidden=true href=#notify-script>#</a></h2><p>And here is a command line version of the script that wraps the <code>notify()</code> function. Note that it&rsquo;s basic functionality is to send a simple alert and maybe attach some log or results files to the email, not to routinely send large amounts of HTML formatted messages!</p><script src=https://gist.github.com/bbengfort/089bbb73f072838ae8d1b0ac859299ff.js></script><h2 id=usage>Usage<a hidden class=anchor aria-hidden=true href=#usage>#</a></h2><p>So now you can send a simple notification as follows:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ notify.py -r jdoe@exmaple.com
</span></span></code></pre></div><p>Or you can edit the subject and message with a few attachments:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ notify.py -r jdoe@example.com -s <span class=s2>&#34;computation complete&#34;</span> results.csv
</span></span></code></pre></div><p>Future versions of this script will allow you to pipe the message in via stdin so that you can chain the emailer along the command line. I also plan to do a better configuration, similar to how AWS CLI configures itself in a simple file in the home directory.</p></div><footer class=post-footer><ul class=post-tags></ul><nav class=paginav><a class=prev href=https://bbengfort.github.io/2017/04/oauth-token-command-line/><span class=title>« Prev</span><br><span>OAuth Tokens on the Command Line</span>
</a><a class=next href=https://bbengfort.github.io/2017/03/grumpy-transpiling-fib-benchmark/><span class=title>Next »</span><br><span>A Benchmark of Grumpy Transpiling</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2024 <a href=https://bbengfort.github.io/>Libelli</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>