<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>snippets | Libelli</title><meta name=keywords content><meta name=description content="The development journal of @bbengfort including notes and ramblings from his various programming activities."><meta name=author content="Benjamin Bengfort"><link rel=canonical href=https://bbengfort.github.io/categories/snippets/><link crossorigin=anonymous href=/assets/css/stylesheet.min.2d6dbfc6e0f8a1db1c9d082a76dc11d094328cf63f247bbc2421dfaa7f2bb170.css integrity="sha256-LW2/xuD4odscnQgqdtwR0JQyjPY/JHu8JCHfqn8rsXA=" rel="preload stylesheet" as=style><link rel=preload href=/icon.png as=image><link rel=icon href=https://bbengfort.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://bbengfort.github.io/icon.png><link rel=icon type=image/png sizes=32x32 href=https://bbengfort.github.io/icon.png><link rel=apple-touch-icon href=https://bbengfort.github.io/apple-touch-icon-precomposed.png><link rel=mask-icon href=https://bbengfort.github.io/icon.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.105.0"><link rel=alternate type=application/rss+xml href=https://bbengfort.github.io/categories/snippets/index.xml><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-8096804-11","auto"),ga("send","pageview"))</script><meta property="og:title" content="snippets"><meta property="og:description" content="The development journal of @bbengfort including notes and ramblings from his various programming activities."><meta property="og:type" content="website"><meta property="og:url" content="https://bbengfort.github.io/categories/snippets/"><meta property="og:image" content="https://bbengfort.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="og:site_name" content="Libelli"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://bbengfort.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="snippets"><meta name=twitter:description content="The development journal of @bbengfort including notes and ramblings from his various programming activities."></head><body class=list id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><noscript><style type=text/css>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:#1d1e20;--entry:#2e2e33;--primary:rgba(255, 255, 255, 0.84);--secondary:rgba(255, 255, 255, 0.56);--tertiary:rgba(255, 255, 255, 0.16);--content:rgba(255, 255, 255, 0.74);--hljs-bg:#2e2e33;--code-bg:#37383e;--border:#333}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><header class=header><nav class=nav><div class=logo><a href=https://bbengfort.github.io accesskey=h title="Libelli (Alt + H)"><img src=/icon.png alt=logo aria-label=logo height=35>Libelli</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu><li><a href=https://bbengfort.github.io/archive/ title=archive><span>archive</span></a></li><li><a href=https://bbengfort.github.io/categories/ title=categories><span>categories</span></a></li><li><a href=https://bbengfort.github.io/search/ title="search (Alt + /)" accesskey=/><span>search</span></a></li><li><a href=https://bbengfort.github.io/about/ title=about><span>about</span></a></li></ul></nav></header><main class=main><header class=page-header><h1>snippets</h1></header><article class="post-entry tag-entry"><header class=entry-header><h2>Sanely gRPC Dial a Remote</h2></header><section class=entry-content><p>In my systems I need to handle failure; so unlike in a typical client-server relationship, I’m prepared for the remote I’m dialing to not be available. Unfortunately when you do this with gRPC-Go there are a couple of annoyances you have to address. They are (in order of solutions):
Verbose connection logging Background and back-off for reconnection attempts Errors are not returned on demand. There is no ability to keep track of statistics So first the logging....</p></section><footer class=entry-footer>March 21, 2017&nbsp;·&nbsp;3 min&nbsp;·&nbsp;Benjamin Bengfort</footer><a class=entry-link aria-label="post link to Sanely gRPC Dial a Remote" href=https://bbengfort.github.io/2017/03/sanely-grpc-dial-a-remote/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2>Pseudo Merkle Tree</h2></header><section class=entry-content><p>A Merkle tree is a data structure in which every non-leaf node is labeled with the hash of its child nodes. This makes them particular useful for comparing large data structures quickly and efficiently. Given trees a and b, if the root hash of either is different, it means that part of the tree below is different (if they are identical, they are probably also identical). You can then proceed in a a breadth first fashion, pruning nodes with identical hashes to directly identify the differences....</p></section><footer class=entry-footer>March 16, 2017&nbsp;·&nbsp;3 min&nbsp;·&nbsp;Benjamin Bengfort</footer><a class=entry-link aria-label="post link to Pseudo Merkle Tree" href=https://bbengfort.github.io/2017/03/pseudo-merkle-tree/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2>Using Select in Go</h2></header><section class=entry-content><p>Ask a Go programmer what makes Go special and they will immediately say “concurrency is baked into the language”. Go’s concurrency model is one of communication (as opposed to locks) and so concurrency primitives are implemented using channels. In order to synchronize across multiple channels, go provides the select statement.
A common pattern for me has become to use a select to manage broadcasted work (either in a publisher/subscriber model or a fanout model) by initializing go routines and passing them directional channels for synchronization and communication....</p></section><footer class=entry-footer>March 8, 2017&nbsp;·&nbsp;2 min&nbsp;·&nbsp;Benjamin Bengfort</footer><a class=entry-link aria-label="post link to Using Select in Go" href=https://bbengfort.github.io/2017/03/channel-select/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2>Synchronizing Structs for Safe Concurrency in Go</h2></header><section class=entry-content><p>Go is built for concurrency by providing language features that allow developers to embed complex concurrency patterns into their applications. These language features can be intuitive and a lot of safety is built in (for example a race detector) but developers still need to be aware of the interactions between various threads in their programs.
In any shared memory system the biggest concern is synchronization: ensuring that separate go routines operate in the correct order and that no race conditions occur....</p></section><footer class=entry-footer>February 21, 2017&nbsp;·&nbsp;4 min&nbsp;·&nbsp;Benjamin Bengfort</footer><a class=entry-link aria-label="post link to Synchronizing Structs for Safe Concurrency in Go" href=https://bbengfort.github.io/2017/02/synchronizing-structs/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2>Extracting a TOC from Markup</h2></header><section class=entry-content><p>In today’s addition of “really simple things that come in handy all the time” I present a simple script to extract the table of contents from markdown or asciidoc files:
So this is pretty simple, just use regular expressions to look for lines that start with one or more "#" or "=" (for markdown and asciidoc, respectively) and print them out with an indent according to their depth (e.g. indent ## heading 2 one block)....</p></section><footer class=entry-footer>February 5, 2017&nbsp;·&nbsp;2 min&nbsp;·&nbsp;Benjamin Bengfort</footer><a class=entry-link aria-label="post link to Extracting a TOC from Markup" href=https://bbengfort.github.io/2017/02/extract-toc/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2>Error Descriptions for System Calls</h2></header><section class=entry-content><p>Working with FUSE to build file systems means inevitably you have to deal with (or return) system call errors. The Go FUSE implementation includes helpers and constants for returning these errors, but simply wraps them around the syscall error numbers. I needed descriptions to better understand what was doing what. Pete saved the day by pointing me towards the errno.h header file on my Macbook. Some Python later and we had the descriptions:...</p></section><footer class=entry-footer>January 23, 2017&nbsp;·&nbsp;1 min&nbsp;·&nbsp;Benjamin Bengfort</footer><a class=entry-link aria-label="post link to Error Descriptions for System Calls" href=https://bbengfort.github.io/2017/01/syscall-errno/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2>Run Until Error with Go Channels</h2></header><section class=entry-content><p>Writing systems means the heavy use of go routines to support concurrent operations. My current architecture employs several go routines to run a server for a simple web interface as well as command line app, file system servers, replica servers, consensus coordination, etc. Using multiple go routines (threads) instead of processes allows for easier development and shared resources, such as a database that can support transactions. However, management of all these threads can be tricky....</p></section><footer class=entry-footer>January 19, 2017&nbsp;·&nbsp;1 min&nbsp;·&nbsp;Benjamin Bengfort</footer><a class=entry-link aria-label="post link to Run Until Error with Go Channels" href=https://bbengfort.github.io/2017/01/run-until-err/></a></article><footer class=page-footer><nav class=pagination><a class=prev href=https://bbengfort.github.io/categories/snippets/page/5/>« Prev Page</a>
<a class=next href=https://bbengfort.github.io/categories/snippets/page/7/>Next Page »</a></nav></footer></main><footer class=footer><span>&copy; 2022 <a href=https://bbengfort.github.io>Libelli</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)"><button class=top-link id=top-link type=button accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></button></a>
<script>let menu=document.getElementById("menu");menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)},document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>